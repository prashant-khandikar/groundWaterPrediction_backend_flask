<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Groundwater Level Predictor</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='predict/style.css') }}">
</head>
<body>
    <div class="main-container">
        <div class="heading-container">
            <h1>Groundwater Level Predictor</h1>
        </div>
        <div class="content-container">
            <div class="form-container">
                <form action="/api/predict" id="my-form" method="post">
                    <label for="option">Select Input Type:</label>
                    <select id="option" name="option">
                        <option value="location">Location</option>
                        <option value="latlong">Latitude/Longitude</option>
                    </select>

                    <div id="location-form">
                        <label for="state">State:</label>
                        <select id="state" name="state">
                            {% for state in states %}
                                <option value="{{ state }}">{{ state }}</option>
                            {% endfor %}
                        </select>

                        <label for="district">District:</label>
                        <select id="district" name="district"></select>

                        <label for="tehsil">Tehsil:</label>
                        <select id="tehsil" name="tehsil"></select>

                        <label for="village">Village:</label>
                        <select id="village" name="village"></select>
                    </div>

                    <div id="latlong-form" style="display: none;">
                        <label for="latitude">Latitude:</label>
                        <input type="text" id="latitude" name="latitude" >

                        <label for="longitude">Longitude:</label>
                        <input type="text" id="longitude" name="longitude" >
                    </div>

                    <label for="year">Year:</label>
                    <input type="number" id="year" name="year" value="{{ default_year }}" min="{{ default_year }}" required>

                    <button type="submit">Predict</button>
                </form>
            </div>
            <div class="image-container">
                <img src="{{ url_for('static', filename='predict_bg_img.jpg') }}" alt="Water Image">
            </div>
        </div>
    </div>
 <!-- Spinner Overlay -->
    <div class="spinner-overlay" id="spinner-overlay">
        <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('my-form').addEventListener('submit', function() {
            document.getElementById('spinner-overlay').style.display = 'flex';
        });
        document.getElementById('option').addEventListener('change', function() {
            if (this.value === 'location') {
                document.getElementById('location-form').style.display = 'block';
                document.getElementById('latlong-form').style.display = 'none';
            } else {
                document.getElementById('location-form').style.display = 'none';
                document.getElementById('latlong-form').style.display = 'block';
            }
        });
// In your index.html, update the fetch URLs to match the blueprint structure
document.getElementById('state').addEventListener('change', function() {
    const state = this.value;
    fetch(`/api/predict/districts/${state}`)
        .then(response => response.json())
        .then(data => {
            const districtSelect = document.getElementById('district');
            districtSelect.innerHTML = '';
            data.forEach(district => {
                const option = document.createElement('option');
                option.value = district;
                option.textContent = district;
                districtSelect.appendChild(option);
            });
            districtSelect.dispatchEvent(new Event('change'));
        })
        .catch(error => console.error('Error fetching districts:', error));
});

document.getElementById('district').addEventListener('change', function() {
    const state = document.getElementById('state').value;
    const district = this.value;
    fetch(`/api/predict/tehsils/${state}/${district}`)
        .then(response => response.json())
        .then(data => {
            const tehsilSelect = document.getElementById('tehsil');
            tehsilSelect.innerHTML = '';
            data.forEach(tehsil => {
                const option = document.createElement('option');
                option.value = tehsil;
                option.textContent = tehsil;
                tehsilSelect.appendChild(option);
            });
            tehsilSelect.dispatchEvent(new Event('change'));
        })
        .catch(error => console.error('Error fetching tehsils:', error));
});

document.getElementById('tehsil').addEventListener('change', function() {
    const state = document.getElementById('state').value;
    const district = document.getElementById('district').value;
    const tehsil = this.value;
    fetch(`/api/predict/villages/${state}/${district}/${tehsil}`)
        .then(response => response.json())
        .then(data => {
            const villageSelect = document.getElementById('village');
            villageSelect.innerHTML = '';
            data.forEach(village => {
                const option = document.createElement('option');
                option.value = village;
                option.textContent = village;
                villageSelect.appendChild(option);
            });
        })
        .catch(error => console.error('Error fetching villages:', error));
});
    </script>
</body>
</html>